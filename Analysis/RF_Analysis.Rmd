---
title: "RF Analysis"
author: "Julisa Lopez"
date: "1/10/2020"
output: html_document
---

```{r Packages} 
library(tidyverse)
library(abind)
library(foreach)
library(haven)
library(labelled)
library(psych)
library(multicon)
library(varhandle)
library(hablar)
library(haven)
library(tidyr)
library(lavaan)
library(dplyr)
library(here)
library(rio)

# install.packages("lavaan")
# install.packages("tidyr")
# devtools::install_github("hadley/tidyverse")

```

```{r Study1 midpoint}
midpoint <- data.frame(midpoint = c(
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4))
```

```{r Study 2 midpoint}
midpoint2 <- data.frame(midpoint = c(
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4))
```

```{r Study 3 midpoint}
midpoint3 <- data.frame(midpoint = c(
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4))
```

```{r Study 4 midpoint}
midpoint4 <- data.frame(midpoint = c(
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4, 4, 4, 4, 4,4, 4, 4, 4, 4, 4, 4, 4, 4, 4,
  4, 4, 4, 4, 4, 4
  ))
```

```{r Functions to center things }

center<-function(MOD)
{
  centered<-MOD-mean(MOD,na.rm=TRUE)
  return(centered)
}

low<-function(MOD)
{
  low<-(MOD-mean(MOD,na.rm=TRUE))+sd(MOD, na.rm=TRUE)
  return(low)
}

high<-function(MOD)
{
  high<-(MOD-mean(MOD, na.rm=TRUE))-sd(MOD, na.rm=TRUE)
  return(high)
}

gmc <- function(MOD, grp) 
  { 
  gmcentered<- (MOD-tapply(MOD,grp,mean,na.rm=TRUE)[grp])
  return(gmcentered)

}

```


Study 1A - T-Test between Redface and Blackface (Between Subjects)

```{r Study 1A - Load in Data}

# Hannah's imac
Study1Arawdataset <- read.csv("/Users/hframil/Desktop/Julisa/RFBF/RFBF.repo/Data/Study1A.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

# Julisa's imac
#Study1Arawdataset <- read.csv("/Users/jujlopez/Documents/Redface/RFBF/RFBF.repo/Data/Study1A.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

# laptop
# Study1Arawdataset <- read.csv("C:/Users/Julisa/Documents/RFBF/RFBF.repo/Data/Study1A.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

Study1Arawdataset<- Study1Arawdataset[-c(1:10), ]  

Study1Arawdataset <- Study1Arawdataset %>% retype()

# Study1Arawdataset <- mutate(Study1Arawdataset, Condition = ifelse(is.na(Study1Arawdataset$Q43), 1, 0))

```

```{r BF OK}

BF1a <- Study1Arawdataset %>% dplyr::select(
  Q112_1, Q112_2, Q112_3, Q112_4,
  Q113_1, Q113_2, Q113_3, Q113_4,
  Q116_1, Q116_2, Q116_3, Q116_4,
  Q136_1, Q136_2, Q136_3, Q136_4,
  Q163_1, Q163_2, Q163_3, Q163_4)

BF.All.Key = c(
  1, -1, 1, -1, 
  1, -1, 1, -1,
  1, -1, 1, -1,
  1, -1, 1, -1,
  1, -1, 1, -1)

BF1a.r <-
  reverse.code(BF.All.Key,
               BF1a,
               mini = 1,
               maxi = 7)

BF1a.df <- as.data.frame(BF1a.r)

BFman_1 <- dplyr::coalesce(BF1a.df$Q112_1, BF1a.df$Q163_1)
BFman_2 <- dplyr::coalesce(BF1a.df$`Q112_2-`, BF1a.df$`Q163_2-`)
BFman_3 <- dplyr::coalesce(BF1a.df$Q112_3, BF1a.df$Q163_3)
BFman_4 <- dplyr::coalesce(BF1a.df$`Q112_4-`, BF1a.df$`Q163_4-`)

BFwom_1 <- BF1a.df$Q113_1
BFwom_2 <- BF1a.df$`Q113_2-`
BFwom_3 <- BF1a.df$Q113_3
BFwom_4 <- BF1a.df$`Q113_4-`

BFgroup_1 <- dplyr::coalesce(BF1a.df$Q116_1, BF1a.df$Q136_1)
BFgroup_2 <- dplyr::coalesce(BF1a.df$`Q116_2-`, BF1a.df$`Q136_2-`)
BFgroup_3 <- dplyr::coalesce(BF1a.df$Q116_3, BF1a.df$Q136_3)
BFgroup_4 <- dplyr::coalesce(BF1a.df$`Q116_4-`, BF1a.df$`Q136_4-`)

BF1a.df <- data.frame(
  BFman_1, BFman_2, BFman_3, BFman_4,
  BFwom_1, BFwom_2, BFwom_3, BFwom_4,
  BFgroup_1, BFgroup_2, BFgroup_3, BFgroup_4
)

BF1aOK <-
  multicon::composite(BF1a.df,
  rel = TRUE, 
  nomiss = 0.6)

```


```{r RF OK}
RF1a <- Study1Arawdataset %>% dplyr::select(
  Q156_1, Q156_2, Q156_3, Q156_4,
  Q123_1, Q123_2, Q123_3, Q123_4,
  Q160_1, Q160_2, Q160_3, Q160_4,
  Q143_1, Q143_2, Q143_3, Q143_4,
  Q148_1, Q148_2, Q148_3, Q148_4)

RF1a.r <-
  reverse.code(BF.All.Key,
               RF1a,
               mini = 1,
               maxi = 7)

RF1a.df <- as.data.frame(RF1a.r)

RFman_1 <- dplyr::coalesce(RF1a.df$Q148_1, RF1a.df$Q123_1)
RFman_2 <- dplyr::coalesce(RF1a.df$`Q148_2-`, RF1a.df$`Q123_2-`)
RFman_3 <- dplyr::coalesce(RF1a.df$Q148_3, RF1a.df$Q123_3)
RFman_4 <- dplyr::coalesce(RF1a.df$`Q148_4-`, RF1a.df$`Q123_4-`)

RFwom_1 <- RF1a.df$Q160_1
RFwom_2 <- RF1a.df$`Q160_2-`
RFwom_3 <- RF1a.df$Q160_3
RFwom_4 <- RF1a.df$`Q160_4-`

RFgroup_1 <- dplyr::coalesce(RF1a.df$Q143_1, RF1a.df$Q156_1)
RFgroup_2 <- dplyr::coalesce(RF1a.df$`Q143_2-`, RF1a.df$`Q156_2-`)
RFgroup_3 <- dplyr::coalesce(RF1a.df$Q143_3, RF1a.df$Q156_3)
RFgroup_4 <- dplyr::coalesce(RF1a.df$`Q143_4-`, RF1a.df$`Q156_4-`)

RF1a.df <- data.frame(
  RFman_1, RFman_2, RFman_3, RFman_4,
  RFwom_1, RFwom_2, RFwom_3, RFwom_4,
  RFgroup_1, RFgroup_2, RFgroup_3, RFgroup_4
)

RF1aOK <-
  multicon::composite(RF1a.df,
  rel = TRUE, 
  nomiss = 0.6)

# RFPaintWom2_1 - Cleveland Indian Woman & BFPaintWom2_1 - Afro Woman
# write.csv(Study1Arawdataset, 'Study1A_W')
```


```{r T test}
t.test(BF1aOK, RF1aOK, paired = TRUE)
t.test(midpoint, BF1aOK, paired = FALSE)
t.test(midpoint, RF1aOK, paired = FALSE)
```

Study 1A - Demographics

```{r Demographics}
# N = 77

# Gender = 55.8%

table(Study1Arawdataset$Gender)

# Age = 19.02
table(Study1Arawdataset$Age)

# FGC Status (N = 52)
Edu1A <- Study1Arawdataset %>% filter(PrimaryEd >= 4 | SecondEdu >= 4)


```

Study 1A - Power analysis

```{r Power Analysis}
power.t.test(n = 77, delta = (mean(BF1aOK) - mean(RF1aOK, na.rm = TRUE)), sig.level = 0.05, power = NULL, type = "paired")

```

Study 1B - T-Test between Redface and Blackface (Between Subjects)

```{r Study 1B - Load in Data}

# Hannah's imac
Study1Brawdataset <- read.csv("/Users/hframil/Desktop/Julisa/RFBF/RFBF.repo/Data/Study1B.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

#imac
# Study1Brawdataset <- read.csv("/Users/jujlopez/Documents/Redface/RFBF/RFBF.repo/Data/Study1B.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

# laptop
# Study1Brawdataset <- read.csv("C:/Users/Julisa/Documents/RFBF/RFBF.repo/Data/Study1B.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

Study1Brawdataset<- Study1Brawdataset[-c(1:2), ]  

Study1Brawdataset <- Study1Brawdataset %>% retype()
```

```{r BF OK}
BF1b <- Study1Brawdataset %>% dplyr::select(
  BFPaint1_1, BFPaint1_2, BFPaint1_3, BFPaint1_4,
  BFPaintWom1_1, BFPaintWom1_2, BFPaintWom1_3, BFPaintWom1_4,
  BFGroup1_1, BFGroup1_2, BFGroup1_3, BFGroup1_4,
  BFPaintMan2_1, BFPaintMan2_2, BFPaintMan2_3, BFPaintMan2_4,
  BFGroup2_1, BFGroup2_2, BFGroup2_3, BFGroup2_4)

BF1b.r <-
  reverse.code(BF.All.Key,
               BF1b,
               mini = 1,
               maxi = 7)

BF1b.df <- as.data.frame(BF1b.r)

BF1bman_1 <- dplyr::coalesce(BF1b.df$BFPaint1_1, BF1b.df$BFPaintMan2_1)
BF1bman_2 <- dplyr::coalesce(BF1b.df$`BFPaint1_2-`, BF1b.df$`BFPaintMan2_2-`)
BF1bman_3 <- dplyr::coalesce(BF1b.df$BFPaint1_3, BF1b.df$BFPaintMan2_3)
BF1bman_4 <- dplyr::coalesce(BF1b.df$`BFPaint1_4-`, BF1b.df$`BFPaintMan2_4-`)

BF1bwom_1 <- BF1b.df$BFPaintWom1_1
BF1bwom_2 <- BF1b.df$`BFPaintWom1_2-`
BF1bwom_3 <- BF1b.df$BFPaintWom1_3
BF1bwom_4 <- BF1b.df$`BFPaintWom1_4-`

BF1bgroup_1 <- dplyr::coalesce(BF1b.df$BFGroup1_1, BF1b.df$BFGroup2_1)
BF1bgroup_2 <- dplyr::coalesce(BF1b.df$`BFGroup1_2-`, BF1b.df$`BFGroup2_2-`)
BF1bgroup_3 <- dplyr::coalesce(BF1b.df$BFGroup1_3, BF1b.df$BFGroup2_3)
BF1bgroup_4 <- dplyr::coalesce(BF1b.df$`BFGroup1_4-`, BF1b.df$`BFGroup2_4-`)

BF1b.df <- data.frame(
  BF1bman_1, BF1bman_2, BF1bman_3, BF1bman_4,
  BF1bwom_1, BF1bwom_2, BF1bwom_3, BF1bwom_4,
  BF1bgroup_1, BF1bgroup_2, BF1bgroup_3, BF1bgroup_4
)

BF1bOK <-
  multicon::composite(BF1b.df,
  rel = TRUE, 
  nomiss = 0.6)
```

```{r RF OK}
RF1b <- Study1Brawdataset %>% dplyr::select(
  RFPaintGroup2_1, RFPaintGroup2_2, RFPaintGroup2_3, RFPaintGroup2_4,
  RFPaintWom1_1, RFPaintWom1_2, RFPaintWom1_3, RFPaintWom1_4,
  RFPaintGroup1_1, RFPaintGroup1_2, RFPaintGroup1_3, RFPaintGroup1_4,
  RFPaintMan2_1, RFPaintMan2_2, RFPaintMan2_3, RFPaintMan2_4,
  RFGroup2_1, RFGroup2_2, RFGroup2_3, RFGroup2_4)

RF1b.r <-
  reverse.code(BF.All.Key,
               RF1b,
               mini = 1,
               maxi = 7)

RF1b.df <- as.data.frame(RF1b.r)

RF1bman_1 <- dplyr::coalesce(RF1b.df$RFPaintGroup2_1, RF1b.df$RFPaintMan2_1)
RF1bman_2 <- dplyr::coalesce(RF1b.df$`RFPaintGroup2_2-`, RF1b.df$`RFPaintMan2_2-`)
RF1bman_3 <- dplyr::coalesce(RF1b.df$RFPaintGroup2_3, RF1b.df$RFPaintMan2_3)
RF1bman_4 <- dplyr::coalesce(RF1b.df$`RFPaintGroup2_4-`, RF1b.df$`RFPaintMan2_4-`)

RF1bwom_1 <- RF1b.df$RFPaintWom1_1
RF1bwom_2 <- RF1b.df$`RFPaintWom1_2-`
RF1bwom_3 <- RF1b.df$RFPaintWom1_3
RF1bwom_4 <- RF1b.df$`RFPaintWom1_4-`

RF1bgroup_1 <- dplyr::coalesce(RF1b.df$RFPaintGroup1_1, RF1b.df$RFGroup2_1)
RF1bgroup_2 <- dplyr::coalesce(RF1b.df$`RFPaintGroup1_2-`, RF1b.df$`RFGroup2_2-`)
RF1bgroup_3 <- dplyr::coalesce(RF1b.df$RFPaintGroup1_3, RF1b.df$RFGroup2_3)
RF1bgroup_4 <- dplyr::coalesce(RF1b.df$`RFPaintGroup1_4-`, RF1b.df$`RFGroup2_4-`)

RF1b.df <- data.frame(
  RF1bman_1, RF1bman_2, RF1bman_3, RF1bman_4,
  RF1bwom_1, RF1bwom_2, RF1bwom_3, RF1bwom_4,
  RF1bgroup_1, RF1bgroup_2, RF1bgroup_3, RF1bgroup_4
)

RF1bOK <-
  multicon::composite(RF1b.df,
  rel = TRUE, 
  nomiss = 0.6)
```

```{r T test}
t.test(BF1bOK, RF1bOK, paired = TRUE)
t.test(midpoint, BF1bOK, paired = FALSE)
t.test(midpoint, RF1bOK, paired = FALSE)
```

Study 1B - Demographics

```{r Demographics}
# N = 103

# Gender
table(Study1Brawdataset$Gender)

# Age
table(Study1Brawdataset$Age)

# FGC Status
Edu1B <- Study1Brawdataset %>% filter(PrimaryEd >= 4 | SecondEdu >= 4)
```

Study 1B - Power analysis

```{r Power Analysis}
power.t.test(n = 103, delta = (mean(BF1bOK, na.rm = TRUE) - mean(RF1bOK, na.rm = TRUE)), sig.level = 0.05, power = NULL, type = "paired")
```

Study 2

Prepping Data 
```{r Study 2 - Load in Data}

# Hannah's imac
# Study2rawdataset <- read.csv("/Users/hframil/Desktop/Julisa/RFBF/RFBF.repo/Data/Study2.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

# imac
# Study2rawdataset <- read.csv("/Users/jujlopez/Documents/Redface/RFBF/RFBF.repo/Data/Study2.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

#laptop
Study2rawdataset <- read.csv("C:/Users/Julisa/Documents/RFBF/RFBF.repo/Data/Study2.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

Study2rawdataset<- Study2rawdataset[-c(1:2), ]  # Getting rid of unneccesary rows

Study2rawdataset <- Study2rawdataset %>% retype()

Study2rawdataset <- mutate(Study2rawdataset, Condition_S2 = ifelse(is.na(Study2rawdataset$BFPaint1), 1, 0)) # creating condition variable

```

```{r BF OK}
BFS2.raw <- Study2rawdataset %>% filter(Condition_S2 == 0) %>% dplyr::select(
  BFPaint1_1, BFPaint1_2, BFPaint1_3, BFPaint1_4,
  BFPaintWom1_1, BFPaintWom1_2, BFPaintWom1_3, BFPaintWom1_4,
  BFGroup1_1, BFGroup1_2, BFGroup1_3, BFGroup1_4,
  BFPaintMan2_1, BFPaintMan2_2, BFPaintMan2_3, BFPaintMan2_4,
  BFGroup2_1, BFGroup2_2, BFGroup2_3, BFGroup2_4
)

BF.Key = c(1, -1, 1, -1, 
           1, -1, 1, -1,
           1, -1, 1, -1,
           1, -1, 1, -1,
           1, -1, 1, -1) #Reverse Scoring Items

BFS2.r <-
  reverse.code(BF.Key,
               BFS2.raw,
               mini = 1,
               maxi = 7)

BFS2.comp <-
  multicon::composite(BFS2.r,
  rel = TRUE, 
  nomiss = 0.6)

BFS2.OK <- as.data.frame(BFS2.comp)

```

```{r RF OK}
RFS2.raw <- Study2rawdataset %>% filter(Condition_S2 == 1) %>% dplyr::select(
  RFPaintGroup2_1, RFPaintGroup2_2, RFPaintGroup2_3, RFPaintGroup2_4, 
  RFPaintWom1_1, RFPaintWom1_2, RFPaintWom1_3, RFPaintWom1_4, 
  RFPaintGroup1_1, RFPaintGroup1_2, RFPaintGroup1_3, RFPaintGroup1_4,
  RFPaintMan2_1, RFPaintMan2_2, RFPaintMan2_3, RFPaintMan2_4, 
  RFGroup2_1, RFGroup2_2, RFGroup2_3, RFGroup2_4
  )

RFS2.r <-
  reverse.code(BF.Key,
               RFS2.raw,
               mini = 1,
               maxi = 7)

RFS2.comp <-
  multicon::composite(RFS2.r,
  rel = TRUE, 
  nomiss = 0.6)

RFS2.OK <- as.data.frame(RFS2.comp)

```

T-test between RFOK and BFOK

```{r T test}
t.test(RFS2.OK, BFS2.OK, paired = FALSE, var.equal = TRUE)

?t.test()
t.test(midpoint2, BFS2.OK, paired = FALSE)
t.test(midpoint2, RFS2.OK, paired = FALSE)

```

Creating Acceptability Variable combining Redface and Blackface
```{r OK}
BFS2.fullraw <- Study2rawdataset %>% dplyr::select(
  BFPaint1_1, BFPaint1_2, BFPaint1_3, BFPaint1_4,
  BFPaintWom1_1, BFPaintWom1_2, BFPaintWom1_3, BFPaintWom1_4,
  BFGroup1_1, BFGroup1_2, BFGroup1_3, BFGroup1_4,
  BFPaintMan2_1, BFPaintMan2_2, BFPaintMan2_3, BFPaintMan2_4,
  BFGroup2_1, BFGroup2_2, BFGroup2_3, BFGroup2_4
)

BFS2.full <-
  reverse.code(BF.Key,
               BFS2.fullraw,
               mini = 1,
               maxi = 7)

BFS2.full <- as.data.frame(BFS2.full)

RFS2.fullraw <- Study2rawdataset %>% dplyr::select(
  RFPaintGroup2_1, RFPaintGroup2_2, RFPaintGroup2_3, RFPaintGroup2_4, 
  RFPaintWom1_1, RFPaintWom1_2, RFPaintWom1_3, RFPaintWom1_4, 
  RFPaintGroup1_1, RFPaintGroup1_2, RFPaintGroup1_3, RFPaintGroup1_4,
  RFPaintMan2_1, RFPaintMan2_2, RFPaintMan2_3, RFPaintMan2_4, 
  RFGroup2_1, RFGroup2_2, RFGroup2_3, RFGroup2_4
  )

RFS2.full <-
  reverse.code(BF.Key,
               RFS2.fullraw,
               mini = 1,
               maxi = 7)

RFS2.full <- as.data.frame(RFS2.full)

S2man1_1 <- dplyr::coalesce(BFS2.full$BFPaint1_1, RFS2.full$RFPaintGroup2_1)
S2man1_2 <- dplyr::coalesce(BFS2.full$`BFPaint1_2-`, RFS2.full$`RFPaintGroup2_2-`)
S2man1_3 <- dplyr::coalesce(BFS2.full$BFPaint1_3, RFS2.full$RFPaintGroup2_3)
S2man1_4 <- dplyr::coalesce(BFS2.full$`BFPaint1_4-`, RFS2.full$`RFPaintGroup2_4-`)

S2man2_1 <- dplyr::coalesce(BFS2.full$BFPaintMan2_1, RFS2.full$RFPaintMan2_1)
S2man2_2 <- dplyr::coalesce(BFS2.full$`BFPaintMan2_2-`, RFS2.full$`RFPaintMan2_2-`)
S2man2_3 <- dplyr::coalesce(BFS2.full$BFPaintMan2_3, RFS2.full$RFPaintMan2_3)
S2man2_4 <- dplyr::coalesce(BFS2.full$`BFPaintMan2_4-`, RFS2.full$`RFPaintMan2_4-`)

S2wom1_1 <- dplyr::coalesce(BFS2.full$BFPaintWom1_1, RFS2.full$RFPaintWom1_1)
S2wom1_2 <- dplyr::coalesce(BFS2.full$`BFPaintWom1_2-`, RFS2.full$`RFPaintWom1_2-`)
S2wom1_3 <- dplyr::coalesce(BFS2.full$BFPaintWom1_3, RFS2.full$RFPaintWom1_3)
S2wom1_4 <- dplyr::coalesce(BFS2.full$`BFPaintWom1_4-`, RFS2.full$`RFPaintWom1_4-`)

S2group1_1 <- dplyr::coalesce(BFS2.full$BFGroup1_1, RFS2.full$RFPaintGroup1_1)
S2group1_2 <- dplyr::coalesce(BFS2.full$`BFGroup1_2-`, RFS2.full$`RFPaintGroup1_2-`)
S2group1_3 <- dplyr::coalesce(BFS2.full$BFGroup1_3, RFS2.full$RFPaintGroup1_3)
S2group1_4 <- dplyr::coalesce(BFS2.full$`BFGroup1_4-`, RFS2.full$`RFPaintGroup1_4-`)

S2group2_1 <- dplyr::coalesce(BFS2.full$BFGroup2_1, RFS2.full$RFGroup2_1)
S2group2_2 <- dplyr::coalesce(BFS2.full$`BFGroup2_2-`, RFS2.full$`RFGroup2_2-`)
S2group2_3 <- dplyr::coalesce(BFS2.full$BFGroup2_3, RFS2.full$RFGroup2_3)
S2group2_4 <- dplyr::coalesce(BFS2.full$`BFGroup2_4-`, RFS2.full$`RFGroup2_4-`)

S2.full.df <- data.frame(
  S2man1_1, S2man1_2, S2man1_3, S2man1_4,
  S2man2_1, S2man2_2, S2man2_3, S2man2_4,
  S2wom1_1, S2wom1_2, S2wom1_3, S2wom1_4,
  S2group1_1, S2group1_2, S2group1_3, S2group1_4,
  S2group2_1, S2group2_2, S2group2_3, S2group2_4)

OK_S2 <-
  multicon::composite(S2.full.df,
  rel = TRUE, 
  nomiss = 0.6)

```

Differences in Racism Minimization Predicting Difference in Acceptability

```{r RacismMini}
BRM.2raw <- Study2rawdataset %>% dplyr::select(
  RacismMini_1, RacismMini_2, RacismMini_3, RacismMini_4, 
  RacismMini_5, RacismMini_6, RacismMini_7, RacismMini_8, 
  RacismMini_9, RacismMini_10
)

RM.key = c(1, -1, 1, -1, 
           -1, -1, -1, 1,
           1, 1
           )

BRM.2r <- reverse.code(RM.key,
                      BRM.2raw,
                      mini = 1,
                      max = 7)

BlkRM_S2 <-
  multicon::composite(BRM.2r,
  rel = TRUE, 
  nomiss = 0.6)

BRM.2df <- as.data.frame(BlkRM_S2)

NRM.2raw <- Study2rawdataset %>% dplyr::select(
  RacismMini_1.1, RacismMini_2.1, RacismMini_3.1, RacismMini_4.1, 
  RacismMini_5.1, RacismMini_6.1, RacismMini_7.1, RacismMini_8.1, 
  RacismMini_9.1, RacismMini_10.1
)

NRM.2r <- reverse.code(RM.key,
                      NRM.2raw,
                      mini = 1,
                      max = 7)

NtvRM_S2 <-
  multicon::composite(NRM.2r,
  rel = TRUE, 
  nomiss = 0.6)

RM_S2 <- dplyr::coalesce(BlkRM_S2, NtvRM_S2)

NRM.2df <- as.data.frame(NtvRM_S2)

RM2_1 <- dplyr::coalesce(BRM.2df$RacismMini_1, NRM.2df$RacismMini_1.1)
RM2_2 <- dplyr::coalesce(BRM.2df$`RacismMini_2-`, NRM.2df$`RacismMini_2.1-`)
RM2_3 <- dplyr::coalesce(BRM.2df$RacismMini_3, NRM.2df$RacismMini_3.1)
RM2_4 <- dplyr::coalesce(BRM.2df$`RacismMini_4-`, NRM.2df$`RacismMini_4.1-`)
RM2_5 <- dplyr::coalesce(BRM.2df$`RacismMini_5-`, NRM.2df$`RacismMini_5.1-`)
RM2_6 <- dplyr::coalesce(BRM.2df$`RacismMini_6-`, NRM.2df$`RacismMini_6.1-`)
RM2_7 <- dplyr::coalesce(BRM.2df$`RacismMini_7-`, NRM.2df$`RacismMini_7.1-`)
RM2_8 <- dplyr::coalesce(BRM.2df$RacismMini_8, NRM.2df$RacismMini_8.1)
RM2_9 <- dplyr::coalesce(BRM.2df$RacismMini_9, NRM.2df$RacismMini_9.1)
RM2_10 <- dplyr::coalesce(BRM.2df$RacismMini_10, NRM.2df$RacismMini_10.1)

RM_S2.df <- data.frame(RM2_1, RM2_2, RM2_3, RM2_4, RM2_5, RM2_6, RM2_7, RM2_8, RM2_9, RM2_10)

RM_S2 <- multicon::composite(RM_S2.df,
  rel = TRUE, 
  nomiss = 0.6)

```

```{r B Linear Regression OK~RM}


```

```{r N Linear Regression OK~RM}

```

```{r Mediation}
X <- Study2rawdataset$Condition_S2
M <- RM_S2
Y <- OK_S2
Data <- data.frame(X=Study2rawdataset$Condition_S2, Y=OK_S2, M=RM_S2)

model <- ' # direct effect
             Y ~ c*X
           # mediator
             M ~ a*X
             Y ~ b*M
           # indirect effect (a*b)
             ab := a*b
           # total effect
             total := c + (a*b)
         '

fit <- sem(model, data = Data)
summary(fit)

```


Demographics

```{r Demographics}
# N = 170

# Gender Women = 57.6
table(Study2rawdataset$Gender)

# Age = 22.41
table(Study2rawdataset$Age)

# FGC Status = 88.2%
Edu2 <- Study2rawdataset %>% filter(PrimaryEd >= 4 | SecondEdu >= 4)

```

```{r Study 3 - Load in Data}

# imac
Study3rawdataset <- read.csv("/Users/jujlopez/Documents/Redface/RFBF/RFBF.repo/Data/Study3.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

#laptop
# Study3rawdataset <- read.csv("C:/Users/Julisa/Documents/RFBF/RFBF.repo/Data/Study3.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

Study3rawdataset <- Study3rawdataset  %>% filter(Race == 3) %>% retype()

Study3rawdataset <- mutate(Study3rawdataset, Condition_S3 = ifelse(is.na(Study3rawdataset$B1_1), 1, 0)) # creating condition variable

```

```{r BF OK}
BFS3.raw <- Study3rawdataset %>% filter(Condition_S3 == 0) %>% dplyr::select(
  B1_1, B1_2, B1_3, B1_4,
  B2_1, B2_2, B2_3, B2_4,
  B3_1, B3_2, B3_3, B3_4,
  B5_1, B5_2, B5_3, B5_4,
  B6_1, B6_2, B6_3, B6_4
)

BF.Key = c(1, -1, 1, -1, 
           1, -1, 1, -1,
           1, -1, 1, -1,
           1, -1, 1, -1,
           1, -1, 1, -1) #Reverse Scoring Items

BFS3.r <-
  reverse.code(BF.Key,
               BFS3.raw,
               mini = 1,
               maxi = 7)

BFS3.OK <-
  multicon::composite(BFS3.r,
  rel = TRUE, 
  nomiss = 0.6)

```

```{r RF OK}
RFS3.raw <- Study3rawdataset %>% filter(Condition_S3 == 1) %>% dplyr::select(
  R1_1, R1_2, R1_3, R1_4, 
  R2_1, R2_2, R2_3, R2_4,
  R3_1, R3_2, R3_3, R3_4,
  R5_1, R5_2, R5_3, R5_4,
  R6_1, R6_2, R6_3, R6_4
  )

RFS3.r <-
  reverse.code(BF.Key,
               RFS3.raw,
               mini = 1,
               maxi = 7)

RFS3.comp <-
  multicon::composite(RFS3.r,
  rel = TRUE, 
  nomiss = 0.6)

RFS3.OK <- as.data.frame(RFS3.comp)

```

T-test between RFOK and BFOK

```{r T test}
t.test(RFS3.OK, BFS3.OK, paired = FALSE)
t.test(midpoint3, BFS3.OK, paired = FALSE)
t.test(midpoint3, RFS3.OK, paired = FALSE)

```

Creating Acceptability Variable combining Redface and Blackface
```{r OK}
BFS3.fullraw <- Study3rawdataset %>% dplyr::select(
  B1_1, B1_2, B1_3, B1_4,
  B2_1, B2_2, B2_3, B2_4,
  B3_1, B3_2, B3_3, B3_4,
  B5_1, B5_2, B5_3, B5_4,
  B6_1, B6_2, B6_3, B6_4
)

BFS3.full <-
  reverse.code(BF.Key,
               BFS3.fullraw,
               mini = 1,
               maxi = 7)

BFS3.full <- as.data.frame(BFS3.full)

RFS3.fullraw <- Study3rawdataset %>% dplyr::select(
  R1_1, R1_2, R1_3, R1_4, 
  R2_1, R2_2, R2_3, R2_4,
  R3_1, R3_2, R3_3, R3_4,
  R5_1, R5_2, R5_3, R5_4,
  R6_1, R6_2, R6_3, R6_4
  )

RFS3.full <-
  reverse.code(BF.Key,
               RFS3.fullraw,
               mini = 1,
               maxi = 7)

RFS3.full <- as.data.frame(RFS3.full)

S3man1_1 <- dplyr::coalesce(BFS3.full$B1_1, RFS3.full$R1_1)
S3man1_2 <- dplyr::coalesce(BFS3.full$`B1_2-`, RFS3.full$`R1__2-`)
S3man1_3 <- dplyr::coalesce(BFS3.full$B1_3, RFS3.full$R1__3)
S3man1_4 <- dplyr::coalesce(BFS3.full$`B1_4-`, RFS3.full$`R1_4-`)

S3man2_1 <- dplyr::coalesce(BFS3.full$B2_1, RFS3.full$R2_1)
S3man2_2 <- dplyr::coalesce(BFS3.full$`B2_2-`, RFS3.full$`R2_2-`)
S3man2_3 <- dplyr::coalesce(BFS3.full$B2_3, RFS3.full$R2_3)
S3man2_4 <- dplyr::coalesce(BFS3.full$`B2_4-`, RFS3.full$`R2_4-`)

S3wom1_1 <- dplyr::coalesce(BFS3.full$B3_1, RFS3.full$R3_1)
S3wom1_2 <- dplyr::coalesce(BFS3.full$`B3_2-`, RFS3.full$`R3_2-`)
S3wom1_3 <- dplyr::coalesce(BFS3.full$B3_3, RFS3.full$R3_3)
S3wom1_4 <- dplyr::coalesce(BFS3.full$`B3_4-`, RFS3.full$`R3_4-`)

S3group1_1 <- dplyr::coalesce(BFS3.full$B5_1, RFS3.full$R5_1)
S3group1_2 <- dplyr::coalesce(BFS3.full$`B5_2-`, RFS3.full$`R5_2-`)
S3group1_3 <- dplyr::coalesce(BFS3.full$B5_3, RFS3.full$R5_3)
S3group1_4 <- dplyr::coalesce(BFS3.full$`B5_4-`, RFS3.full$`R5_4-`)

S3group2_1 <- dplyr::coalesce(BFS3.full$B6_1, RFS3.full$R6_1)
S3group2_2 <- dplyr::coalesce(BFS3.full$`B6_2-`, RFS3.full$`R6_2-`)
S3group2_3 <- dplyr::coalesce(BFS3.full$B6_3, RFS3.full$R6_3)
S3group2_4 <- dplyr::coalesce(BFS3.full$`B6_4-`, RFS3.full$`R6_4-`)

S3.full.df <- data.frame(
  S3man1_1, S3man1_2, S3man1_3, S3man1_4,
  S3man2_1, S3man2_2, S3man2_3, S3man2_4,
  S3wom1_1, S3wom1_2, S3wom1_3, S3wom1_4,
  S3group1_1, S3group1_2, S3group1_3, S3group1_4,
  S3group2_1, S3group2_2, S3group2_3, S3group2_4)

OK_S3 <-
  multicon::composite(S3.full.df,
  rel = TRUE, 
  nomiss = 0.6)

```

Differences in Racism Minimization Predicting Difference in Acceptability

```{r RacismMini}
BRM.3raw <- Study3rawdataset %>% dplyr::select(
  BlkRacismMini_1, BlkRacismMini_2, BlkRacismMini_3, BlkRacismMini_4, 
  BlkRacismMini_5, BlkRacismMini_6, BlkRacismMini_7, BlkRacismMini_8, 
  BlkRacismMini_9, BlkRacismMini_10
)

RM.3key = c(1, -1, 1, -1, 
           -1, -1, -1, 1,
           1, 1
           )

BRM.3r <- reverse.code(RM.3key,
                      BRM.3raw,
                      mini = 1,
                      max = 7)

BRM.3 <- multicon::composite(BRM.3r,
  rel = TRUE, 
  nomiss = 0.6)

BRM.3df <- as.data.frame(BRM.3r)

NRM.3raw <- Study3rawdataset %>% dplyr::select(
  NtvRacismMini_1, NtvRacismMini_2, NtvRacismMini_3, BtvRacismMini_4, 
  NtvRacismMini_5, NtvRacismMini_6, NtvRacismMini_7, NtvRacismMini_8, 
  NtvRacismMini_9, NtvRacismMini_10
)

NRM.3r <- reverse.code(RM.3key,
                      NRM.3raw,
                      mini = 1,
                      max = 7)

NRM.3 <- multicon::composite(NRM.3r,
  rel = TRUE, 
  nomiss = 0.6)

NRM.3df <- as.data.frame(NRM.3r)

RM3_1 <- dplyr::coalesce(BRM.3df$BlkRacismMini_1, NRM.3df$NtvRacismMini_1)
RM3_2 <- dplyr::coalesce(BRM.3df$`BlkRacismMini_2-`, NRM.3df$`NtvRacismMini_2-`)
RM3_3 <- dplyr::coalesce(BRM.3df$BlkRacismMini_3, NRM.3df$NtvRacismMini_3)
RM3_4 <- dplyr::coalesce(BRM.3df$`BlkRacismMini_4-`, NRM.3df$`BtvRacismMini_4-`)
RM3_5 <- dplyr::coalesce(BRM.3df$`BlkRacismMini_5-`, NRM.3df$`NtvRacismMini_5-`)
RM3_6 <- dplyr::coalesce(BRM.3df$`BlkRacismMini_6-`, NRM.3df$`NtvRacismMini_6-`)
RM3_7 <- dplyr::coalesce(BRM.3df$`BlkRacismMini_7-`, NRM.3df$`NtvRacismMini_7-`)
RM3_8 <- dplyr::coalesce(BRM.3df$BlkRacismMini_8, NRM.3df$NtvRacismMini_8)
RM3_9 <- dplyr::coalesce(BRM.3df$BlkRacismMini_9, NRM.3df$NtvRacismMini_9)
RM3_10 <- dplyr::coalesce(BRM.3df$BlkRacismMini_10, NRM.3df$NtvRacismMini_10)

RM_S3.df <- data.frame(RM3_1, RM3_2, RM3_3, RM3_4, RM3_5, RM3_6, RM3_7, RM3_8, RM3_9, RM3_10)

RM_S3 <- multicon::composite(RM_S3.df,
  rel = TRUE, 
  nomiss = 0.6)

```

```{r Invisibility}
BIN.3raw <- Study3rawdataset %>% dplyr::select(
  BlkContemporaryInvis_1, BlkContemporaryInvis_2, BlkContemporaryInvis_3,
  BlkContemporaryInvis_4, BlkContemporaryInvis_5, BlkContemporaryInvis_6
  )

IN.3key = c(1, -1, 1, 
            1, 1, 1)

BIN.3r <- reverse.code(IN.3key,
                      BIN.3raw,
                      mini = 1,
                      max = 7)

BIN.3df <- as.data.frame(BIN.3r)

NIN.3raw <- Study3rawdataset %>% dplyr::select(
  NtvContemporaryInvis_1, NtvContemporaryInvis_2, NtvContemporaryInvis_3,
  NtvContemporaryInvis_4, NtvContemporaryInvis_5, NtvContemporaryInvis_6)

NIN.3r <- reverse.code(IN.3key,
                      NIN.3raw,
                      mini = 1,
                      max = 7)

NIN.3df <- as.data.frame(NIN.3r)

IN3_1 <- dplyr::coalesce(BIN.3df$BlkContemporaryInvis_1, NIN.3df$NtvContemporaryInvis_1)
IN3_2 <- dplyr::coalesce(BIN.3df$`BlkContemporaryInvis_2-`, NIN.3df$`NtvContemporaryInvis_2-`)
IN3_3 <- dplyr::coalesce(BIN.3df$BlkContemporaryInvis_3, NIN.3df$NtvContemporaryInvis_3)
IN3_4 <- dplyr::coalesce(BIN.3df$BlkContemporaryInvis_4, NIN.3df$NtvContemporaryInvis_4)
IN3_5 <- dplyr::coalesce(BIN.3df$BlkContemporaryInvis_5, NIN.3df$NtvContemporaryInvis_5)
IN3_6 <- dplyr::coalesce(BIN.3df$BlkContemporaryInvis_6, NIN.3df$NtvContemporaryInvis_6)


IN_S3.df <- data.frame(IN3_1, IN3_2, IN3_3, IN3_4, IN3_5, IN3_6)

IN_S3 <- multicon::composite(IN_S3.df,
  rel = TRUE, 
  nomiss = 0.6)
```

```{r B Linear Regression OK~RM}

```

```{r N Linear Regression OK~RM}

```


```{r Serial Mediation}
X <- Study3rawdataset$Condition_S3
M1 <- IN_S3
M2 <- RM_S3
Y <- OK_S3
Data <- data.frame(X=Study3rawdataset$Condition_S3, Y=OK_S3, M1=IN_S3, M2=RM_S3)

multipleMediation <- '
    Y ~ b1 * M1 + b2 * M2 + c * X
    M1 ~ a1 * X
    M2 ~ a2 * X
    indirect1 := a1 * b1
    indirect2 := a2 * b2
    total    := c + (a1 * b1) + (a2 * b2)
    M1 ~~ M2 
'
fit <- sem(model = multipleMediation, data = Data)
summary(fit)  

```

Demographics

```{r Demographics}
# N = 735

# Gender Women = 48.2
table(Study3rawdataset$Gender)

# Age = 22.41
Study3rawdataset[Study3rawdataset$IPAddress == "174.240.10.13", "Age"] <- as.integer(39)
Study3rawdataset[Study3rawdataset$IPAddress == "162.232.177.134", "Age"] <- as.integer(28)

sd(as.numeric(Study3rawdataset$Age), na.rm = TRUE)

# FGC Status = 88.2%
Edu3 <- Study3rawdataset %>% filter(PrimaryEd >= 4 | SecondEdu >= 4)

```


```{r Study 4 - Load in Data}

# imac
Study4rawdataset <- read.csv("/Users/jujlopez/Documents/Redface/RFBF/RFBF.repo/Data/Study4.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

#laptop
# Study4rawdataset <- read.csv("C:/Users/Julisa/Documents/RFBF/RFBF.repo/Data/Study4.csv", header = T, sep = ",", na=-99, stringsAsFactors = FALSE)

Study4rawdataset<- Study4rawdataset[-c(1:6), ]  # Getting rid of unneccesary rows

Study4rawdataset <- Study4rawdataset  %>% filter(Race == 3) %>% retype()

Study3rawdataset <- mutate(Study3rawdataset, Condition_S3 = ifelse(is.na(Study3rawdataset$B1_1), 1, 0))



```

```{r BF OK}
BFS4.raw <- Study4rawdataset %>% dplyr::select(
  B1_1, B1_2, B1_3, B1_4,
  B2_1, B2_2, B2_3, B2_4,
  B3_1, B3_2, B3_3, B3_4)

BF.4Key = c(1, -1, 1, -1, 
           1, -1, 1, -1,
           1, -1, 1, -1) #Reverse Scoring Items

BFS4.r <-
  reverse.code(BF.4Key,
               BFS4.raw,
               mini = 1,
               maxi = 7)

BFS4.comp <-
  multicon::composite(BFS4.r,
  rel = TRUE, 
  nomiss = 0.6)

BFS4.OK <- as.data.frame(BFS4.comp)

```

```{r RF OK}
RFS4.raw <- Study4rawdataset %>% dplyr::select(
  R1_1, R1_2, R1_3, R1_4, 
  R2_1, R2_2, R2_3, R2_4,
  R3_1, R3_2, R3_3, R3_4)

RFS4.r <-
  reverse.code(BF.4Key,
               RFS4.raw,
               mini = 1,
               maxi = 7)

RFS4.comp <-
  multicon::composite(RFS4.r,
  rel = TRUE, 
  nomiss = 0.6)

view(RFS4.comp)

RFS4.OK <- as.data.frame(RFS4.comp)

```

T-test between RFOK and BFOK

```{r T test}
t.test(RFS4.comp, BFS4.comp, paired = TRUE)
t.test(midpoint4, BFS4.comp, paired = FALSE)
t.test(midpoint4, RFS4.comp, paired = FALSE)
```

```{r RacismMini}
BRM.4raw <- Study4rawdataset %>% dplyr::select(
  BlkRacismMini_1, BlkRacismMini_2, BlkRacismMini_3, BlkRacismMini_4, 
  BlkRacismMini_5, BlkRacismMini_6, BlkRacismMini_7, BlkRacismMini_8, 
  BlkRacismMini_9, BlkRacismMini_10
)

RM.4key = c(1, -1, 1, -1, 
           -1, -1, -1, 1,
           1, 1
           )

BRM.4r <- reverse.code(RM.4key,
                      BRM.4raw,
                      mini = 1,
                      max = 7)

BRM_S4 <- multicon::composite(BRM.4r,
  rel = TRUE, 
  nomiss = 0.6)

BRM.4df <- as.data.frame(BRM_S4)

NRM.4raw <- Study4rawdataset %>% dplyr::select(
  NtvRacismMini_1, NtvRacismMini_2, NtvRacismMini_3, NtvRacismMini_4, 
  NtvRacismMini_5, NtvRacismMini_6, NtvRacismMini_7, NtvRacismMini_8, 
  NtvRacismMini_9, NtvRacismMini_10
)

NRM.4r <- reverse.code(RM.4key,
                      NRM.4raw,
                      mini = 1,
                      max = 7)

NRM_S4 <- multicon::composite(NRM.4r,
  rel = TRUE, 
  nomiss = 0.6)

NRM.4df <- as.data.frame(NRM_S4)

```

```{r Invisibility}
BIN.4raw <- Study4rawdataset %>% dplyr::select(
  BlkContemporaryInvis_1, BlkContemporaryInvis_2, BlkContemporaryInvis_3,
  BlkContemporaryInvis_4, BlkContemporaryInvis_5, BlkContemporaryInvis_6
  )

IN.4key = c(1, -1, 1, 
            1, 1, 1)

BIN.4r <- reverse.code(IN.4key,
                      BIN.4raw,
                      mini = 1,
                      max = 7)

BIN_S4 <- multicon::composite(BIN.4r,
  rel = TRUE, 
  nomiss = 0.6)

BIN.4df <- as.data.frame(BIN_S4)

NIN.4raw <- Study4rawdataset %>% dplyr::select(
  NtvContemporaryInvis_1, NtvContemporaryInvis_2, NtvContemporaryInvis_3,
  NtvContemporaryInvis_4, NtvContemporaryInvis_5, NtvContemporaryInvis_6)

NIN.4r <- reverse.code(IN.4key,
                      NIN.4raw,
                      mini = 1,
                      max = 7)

NIN_S4 <- multicon::composite(NIN.4r,
  rel = TRUE, 
  nomiss = 0.6)

NIN.4df <- as.data.frame(NIN_S4)

```

```{r B Linear Regression OK~RM}

```

```{r N Linear Regression OK~RM}
table1::table1(~NRM.4df BRM.4df| ReservationExperience, data=MascotDataNative)
```


```{r Mediation}
X <- Study3rawdataset$Condition_S3
M1 <- IN_S3
M2 <- RM_S3
Y <- OK_S3
Data <- data.frame(X=Study3rawdataset$Condition_S3, Y=OK_S3, M1=IN_S3, M2=RM_S3)

multipleMediation <- '
    Y ~ b1 * M1 + b2 * M2 + c * X
    M1 ~ a1 * X
    M2 ~ a2 * X
    indirect1 := a1 * b1
    indirect2 := a2 * b2
    total    := c + (a1 * b1) + (a2 * b2)
    M1 ~~ M2 
'
fit <- sem(model = multipleMediation, data = Data)
summary(fit)  

```

Demographics

```{r Demographics}
# N = 170

# Gender Women = 57.6
table(Study3rawdataset$Gender)

# Age = 22.41
table(Study3rawdataset$Age)

# FGC Status = 88.2%
Edu3 <- Study3rawdataset %>% filter(PrimaryEd >= 4 | SecondEdu >= 4)

```
